{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\arije\\\\OneDrive\\\\Desktop\\\\MinorProject\\\\track-donations\\\\src\\\\components\\\\createCampaign\\\\PaymentGateway.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { ethers } from \"ethers\";\nimport { paymentABI, paymentAddress } from \"../paymentContract/constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PaymentGateway() {\n  _s();\n\n  const {\n    ethereum\n  } = window;\n  const [amountData, setAmountData] = useState(\"\");\n  const [addressData, setAddressData] = useState(\"\");\n  const [currentAccount, setCurrentAccount] = useState(\"\");\n  const [vendor, setVendor] = useState(\"\");\n  const [location, setLocation] = useState(\"\");\n  const date = new Date(); //   console.log(date);\n\n  const stringDate = date.toLocaleDateString();\n  console.log(stringDate);\n\n  const createEthereumContract = () => {\n    const provider = new ethers.providers.Web3Provider(ethereum);\n    const signer = provider.getSigner();\n    const paymentContract = new ethers.Contract(paymentAddress, paymentABI, signer);\n    return paymentContract;\n  };\n\n  const paymentContract = createEthereumContract();\n\n  const handleName = e => {\n    setVendor(e.target.value);\n  };\n\n  const handleLocation = e => {\n    setLocation(e.target.value);\n  };\n\n  const handleChange = e => {\n    setAmountData(e.target.value);\n  };\n\n  const handleAddress = e => {\n    setAddressData(e.target.value);\n  }; //   ethereum.on(\"accountsChanged\", function () {\n  //     window.location.reload();\n  //   });\n\n\n  useEffect(() => {\n    async function connectWallet() {\n      if (typeof ethereum !== \"undefined\") {\n        const accounts = await ethereum.request({\n          method: \"eth_requestAccounts\"\n        });\n        setCurrentAccount(accounts[0]);\n      }\n    }\n\n    connectWallet();\n  }, [currentAccount, setCurrentAccount, ethereum]);\n\n  const sendETH = async e => {\n    e.preventDefault();\n\n    try {\n      if (ethereum) {\n        const parsedAmount = ethers.utils.parseEther(amountData);\n        await ethereum.request({\n          method: \"eth_sendTransaction\",\n          params: [{\n            from: currentAccount,\n            to: addressData,\n            gas: \"0x5208\",\n            value: parsedAmount._hex\n          }]\n        });\n        const paymentHash = await paymentContract.pay(currentAccount, addressData, vendor, location, amountData, stringDate);\n        await paymentHash.wait();\n        const deets = await paymentContract.getDetails();\n        console.log(deets);\n      } else {\n        console.log(\"No ethereum object\");\n      }\n    } catch (error) {\n      console.log(error);\n      throw new Error(\"No ethereum object\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"single-outer\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"single-card-item-gateway\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"gateway-form\",\n        onSubmit: sendETH,\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"gateway-lable\",\n          children: \"TRANSFER TO\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"transfer-to-account\",\n          className: \"transfer-to\",\n          type: \"text\",\n          required: true,\n          autoComplete: \"off\",\n          onChange: handleAddress\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"gateway-lable\",\n          children: \"VENDOR NAME\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"vendor-name\",\n          className: \"vendor-name\",\n          type: \"text\",\n          required: true,\n          autoComplete: \"off\",\n          onChange: handleName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"gateway-lable\",\n          children: \"VENDOR LOCATION\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"vendor-location\",\n          className: \"vendor-location\",\n          type: \"text\",\n          required: true,\n          autoComplete: \"off\",\n          onChange: handleLocation\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"gateway-lable\",\n          children: \"AMOUNT (ETH)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"amount\",\n          className: \"amount\",\n          type: \"number\",\n          required: true,\n          autoComplete: \"off\",\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"variable-width-btn button-su transaction-list-btn\",\n          type: \"submit\",\n          children: \"TRANSFER\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PaymentGateway, \"OSaD2jGvYamwghMYZvBaux3dZ5M=\");\n\n_c = PaymentGateway;\n\nvar _c;\n\n$RefreshReg$(_c, \"PaymentGateway\");","map":{"version":3,"names":["React","useState","useEffect","ethers","paymentABI","paymentAddress","PaymentGateway","ethereum","window","amountData","setAmountData","addressData","setAddressData","currentAccount","setCurrentAccount","vendor","setVendor","location","setLocation","date","Date","stringDate","toLocaleDateString","console","log","createEthereumContract","provider","providers","Web3Provider","signer","getSigner","paymentContract","Contract","handleName","e","target","value","handleLocation","handleChange","handleAddress","connectWallet","accounts","request","method","sendETH","preventDefault","parsedAmount","utils","parseEther","params","from","to","gas","_hex","paymentHash","pay","wait","deets","getDetails","error","Error"],"sources":["C:/Users/arije/OneDrive/Desktop/MinorProject/track-donations/src/components/createCampaign/PaymentGateway.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport { paymentABI, paymentAddress } from \"../paymentContract/constants\";\r\nexport default function PaymentGateway() {\r\n  const { ethereum } = window;\r\n  const [amountData, setAmountData] = useState(\"\");\r\n  const [addressData, setAddressData] = useState(\"\");\r\n  const [currentAccount, setCurrentAccount] = useState(\"\");\r\n  const [vendor, setVendor] = useState(\"\");\r\n  const [location, setLocation] = useState(\"\");\r\n  const date = new Date();\r\n//   console.log(date);\r\n  const stringDate = date.toLocaleDateString();\r\n  console.log(stringDate)\r\n  const createEthereumContract = () => {\r\n    const provider = new ethers.providers.Web3Provider(ethereum);\r\n    const signer = provider.getSigner();\r\n    const paymentContract = new ethers.Contract(\r\n      paymentAddress,\r\n      paymentABI,\r\n      signer\r\n    );\r\n    return paymentContract;\r\n  };\r\n\r\n  const paymentContract = createEthereumContract();\r\n  const handleName = (e) => {\r\n    setVendor(e.target.value);\r\n  };\r\n  const handleLocation = (e) => {\r\n    setLocation(e.target.value);\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    setAmountData(e.target.value);\r\n  };\r\n  const handleAddress = (e) => {\r\n    setAddressData(e.target.value);\r\n  };\r\n  //   ethereum.on(\"accountsChanged\", function () {\r\n  //     window.location.reload();\r\n  //   });\r\n\r\n  useEffect(() => {\r\n    async function connectWallet() {\r\n      if (typeof ethereum !== \"undefined\") {\r\n        const accounts = await ethereum.request({\r\n          method: \"eth_requestAccounts\",\r\n        });\r\n        setCurrentAccount(accounts[0]);\r\n      }\r\n    }\r\n    connectWallet();\r\n  }, [currentAccount, setCurrentAccount, ethereum]);\r\n  const sendETH = async (e) => {\r\n    e.preventDefault();\r\n\r\n    try {\r\n      if (ethereum) {\r\n        const parsedAmount = ethers.utils.parseEther(amountData);\r\n        await ethereum.request({\r\n          method: \"eth_sendTransaction\",\r\n          params: [\r\n            {\r\n              from: currentAccount,\r\n              to: addressData,\r\n              gas: \"0x5208\",\r\n              value: parsedAmount._hex,\r\n            },\r\n          ],\r\n        });\r\n        const paymentHash = await paymentContract.pay(\r\n          currentAccount,\r\n          addressData,\r\n          vendor,\r\n          location,\r\n          amountData,\r\n          stringDate\r\n        );\r\n        await paymentHash.wait();\r\n        const deets = await paymentContract.getDetails();\r\n        console.log(deets);\r\n      } else {\r\n        console.log(\"No ethereum object\");\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      throw new Error(\"No ethereum object\");\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"single-outer\">\r\n      <div className=\"single-card-item-gateway\">\r\n        <form className=\"gateway-form\" onSubmit={sendETH}>\r\n          <p className=\"gateway-lable\">TRANSFER TO</p>\r\n          <br />\r\n          <input\r\n            id=\"transfer-to-account\"\r\n            className=\"transfer-to\"\r\n            type=\"text\"\r\n            required\r\n            autoComplete=\"off\"\r\n            onChange={handleAddress}\r\n          />\r\n          <br />\r\n          <p className=\"gateway-lable\">VENDOR NAME</p>\r\n          <br />\r\n          <input\r\n            id=\"vendor-name\"\r\n            className=\"vendor-name\"\r\n            type=\"text\"\r\n            required\r\n            autoComplete=\"off\"\r\n            onChange={handleName}\r\n          />\r\n          <br />\r\n          <p className=\"gateway-lable\">VENDOR LOCATION</p>\r\n          <br />\r\n          <input\r\n            id=\"vendor-location\"\r\n            className=\"vendor-location\"\r\n            type=\"text\"\r\n            required\r\n            autoComplete=\"off\"\r\n            onChange={handleLocation}\r\n          />\r\n          <br />\r\n          <p className=\"gateway-lable\">AMOUNT (ETH)</p>\r\n          <br />\r\n          <input\r\n            id=\"amount\"\r\n            className=\"amount\"\r\n            type=\"number\"\r\n            required\r\n            autoComplete=\"off\"\r\n            onChange={handleChange}\r\n          />\r\n          <br />\r\n          <button\r\n            className=\"variable-width-btn button-su transaction-list-btn\"\r\n            type=\"submit\"\r\n          >\r\n            TRANSFER\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}