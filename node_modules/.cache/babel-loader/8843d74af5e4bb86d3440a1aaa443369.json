{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\arije\\\\OneDrive\\\\Desktop\\\\MinorProject\\\\track-donations\\\\src\\\\components\\\\createCampaign\\\\PaymentGateway.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { ethers } from \"ethers\";\nimport { paymentABI, paymentAddress } from \"../paymentContract/constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PaymentGateway() {\n  _s();\n\n  const {\n    ethereum\n  } = window;\n  const [amountData, setAmountData] = useState(\"\");\n  const [addressData, setAddressData] = useState(\"\");\n  const [currentAccount, setCurrentAccount] = useState(\"\");\n  const date = new Date();\n\n  const createEthereumContract = () => {\n    const provider = new ethers.providers.Web3Provider(ethereum);\n    const signer = provider.getSigner();\n    const paymentContract = new ethers.Contract(paymentAddress, paymentABI, signer);\n    return paymentContract;\n  };\n\n  const paymentContract = createEthereumContract();\n\n  const handleChange = e => {\n    setAmountData(e.target.value);\n  };\n\n  const handleAddress = e => {\n    setAddressData(e.target.value);\n  }; //   ethereum.on(\"accountsChanged\", function () {\n  //     window.location.reload();\n  //   });\n\n\n  useEffect(() => {\n    async function connectWallet() {\n      if (typeof ethereum !== \"undefined\") {\n        const accounts = await ethereum.request({\n          method: \"eth_requestAccounts\"\n        });\n        setCurrentAccount(accounts[0]);\n      }\n    }\n\n    connectWallet();\n  }, [currentAccount, setCurrentAccount, ethereum]);\n\n  const sendETH = async e => {\n    e.preventDefault();\n\n    try {\n      if (ethereum) {\n        const parsedAmount = ethers.utils.parseEther(amountData);\n        await ethereum.request({\n          method: \"eth_sendTransaction\",\n          params: [{\n            from: currentAccount,\n            to: addressData,\n            gas: \"0x5208\",\n            value: parsedAmount._hex\n          }]\n        });\n        const paymentHash = await paymentContract.pay(currentAccount, addressData, value, date, date);\n        await paymentHash.wait();\n        const deets = await paymentContract.getDetails();\n        console.log(deets);\n      } else {\n        console.log(\"No ethereum object\");\n      }\n    } catch (error) {\n      console.log(error);\n      throw new Error(\"No ethereum object\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"single-outer\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"single-card-item-gateway\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"gateway-form\",\n        onSubmit: sendETH,\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"gateway-lable\",\n          children: \"TRANSFER TO\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"transfer-to-account\",\n          className: \"transfer-to\",\n          type: \"text\",\n          required: true,\n          autoComplete: \"off\",\n          onChange: handleAddress\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"gateway-lable\",\n          children: \"AMOUNT (ETH)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"amount\",\n          className: \"amount\",\n          type: \"number\",\n          required: true,\n          autoComplete: \"off\",\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"variable-width-btn button-su transaction-list-btn\",\n          type: \"submit\",\n          children: \"TRANSFER\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PaymentGateway, \"xf2BRg51zZgELU1Z83JYeYwiF1U=\");\n\n_c = PaymentGateway;\n\nvar _c;\n\n$RefreshReg$(_c, \"PaymentGateway\");","map":{"version":3,"names":["React","useState","useEffect","ethers","paymentABI","paymentAddress","PaymentGateway","ethereum","window","amountData","setAmountData","addressData","setAddressData","currentAccount","setCurrentAccount","date","Date","createEthereumContract","provider","providers","Web3Provider","signer","getSigner","paymentContract","Contract","handleChange","e","target","value","handleAddress","connectWallet","accounts","request","method","sendETH","preventDefault","parsedAmount","utils","parseEther","params","from","to","gas","_hex","paymentHash","pay","wait","deets","getDetails","console","log","error","Error"],"sources":["C:/Users/arije/OneDrive/Desktop/MinorProject/track-donations/src/components/createCampaign/PaymentGateway.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport { paymentABI, paymentAddress } from \"../paymentContract/constants\";\r\nexport default function PaymentGateway() {\r\n  const { ethereum } = window;\r\n  const [amountData, setAmountData] = useState(\"\");\r\n  const [addressData, setAddressData] = useState(\"\");\r\n  const [currentAccount, setCurrentAccount] = useState(\"\");\r\n  const date = new Date();\r\n  const createEthereumContract = () => {\r\n    const provider = new ethers.providers.Web3Provider(ethereum);\r\n    const signer = provider.getSigner();\r\n    const paymentContract = new ethers.Contract(\r\n      paymentAddress,\r\n      paymentABI,\r\n      signer\r\n    );\r\n    return paymentContract;\r\n  };\r\n\r\n  const paymentContract = createEthereumContract();\r\n\r\n  const handleChange = (e) => {\r\n    setAmountData(e.target.value);\r\n  };\r\n  const handleAddress = (e) => {\r\n    setAddressData(e.target.value);\r\n  };\r\n  //   ethereum.on(\"accountsChanged\", function () {\r\n  //     window.location.reload();\r\n  //   });\r\n\r\n  useEffect(() => {\r\n    async function connectWallet() {\r\n      if (typeof ethereum !== \"undefined\") {\r\n        const accounts = await ethereum.request({\r\n          method: \"eth_requestAccounts\",\r\n        });\r\n        setCurrentAccount(accounts[0]);\r\n      }\r\n    }\r\n    connectWallet();\r\n  }, [currentAccount, setCurrentAccount, ethereum]);\r\n  const sendETH = async (e) => {\r\n    e.preventDefault();\r\n\r\n    try {\r\n      if (ethereum) {\r\n        const parsedAmount = ethers.utils.parseEther(amountData);\r\n        await ethereum.request({\r\n          method: \"eth_sendTransaction\",\r\n          params: [\r\n            {\r\n              from: currentAccount,\r\n              to: addressData,\r\n              gas: \"0x5208\",\r\n              value: parsedAmount._hex,\r\n            },\r\n          ],\r\n        });\r\n        const paymentHash = await paymentContract.pay(\r\n          currentAccount,\r\n          addressData,\r\n          value,\r\n          date,\r\n          date\r\n        );\r\n        await paymentHash.wait();\r\n        const deets = await paymentContract.getDetails();\r\n        console.log(deets);\r\n      } else {\r\n        console.log(\"No ethereum object\");\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      throw new Error(\"No ethereum object\");\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"single-outer\">\r\n      <div className=\"single-card-item-gateway\">\r\n        <form className=\"gateway-form\" onSubmit={sendETH}>\r\n          <p className=\"gateway-lable\">TRANSFER TO</p>\r\n          <br />\r\n          <input\r\n            id=\"transfer-to-account\"\r\n            className=\"transfer-to\"\r\n            type=\"text\"\r\n            required\r\n            autoComplete=\"off\"\r\n            onChange={handleAddress}\r\n          />\r\n          <br />\r\n          <p className=\"gateway-lable\">AMOUNT (ETH)</p>\r\n          <br />\r\n          <input\r\n            id=\"amount\"\r\n            className=\"amount\"\r\n            type=\"number\"\r\n            required\r\n            autoComplete=\"off\"\r\n            onChange={handleChange}\r\n          />\r\n          <br />\r\n          <button\r\n            className=\"variable-width-btn button-su transaction-list-btn\"\r\n            type=\"submit\"\r\n          >\r\n            TRANSFER\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}